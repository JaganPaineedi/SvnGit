/********************************************************************************************
Author			:  Alok Kumar 
ModifiedDate	:  03/24/2016 
Purpose			:  Insert/Update script for GlobalCodes.CodeName[REFERRALTYPE] for task#175 New Directions - Support Go Live
*********************************************************************************************/

--Insert Script for GlobalCodeCategories 'REFERRALTYPE'
IF NOT EXISTS (SELECT * FROM dbo.GlobalCodeCategories WHERE Category = 'REFERRALTYPE') BEGIN INSERT INTO dbo.GlobalCodeCategories ( Category, CategoryName, Active, AllowAddDelete, AllowCodeNameEdit, AllowSortOrderEdit, Description, UserDefinedCategory, HasSubcodes, UsedInPracticeManagement, UsedInCareManagement) VALUES('REFERRALTYPE','Referral Type','Y','Y','Y','Y',NULL,'N','Y','N','Y') END



--Insert Script for GlobalCode 'REFERRALTYPE'
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','ADES',NULL,'Y','Y',1,'26') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='26' WHERE Category = 'REFERRALTYPE' And CodeName='ADES' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Advocacy Group',NULL,'Y','Y',1,'30') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='30' WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Aging and People with Disabilities',NULL,'Y','Y',1,'03') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='03' WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Attorney',NULL,'Y','Y',1,'31') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='31' WHERE Category = 'REFERRALTYPE' And CodeName='Attorney' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Child Welfare (CW)',NULL,'Y','Y',1,'01') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='01' WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Coordinated Care Organization',NULL,'Y','Y',1,'11') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='11' WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Crisis/Helpline',NULL,'Y','Y',1,'32') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='32' WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Developmental Disabilities',NULL,'Y','Y',1,'04') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='04' WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Employment/EAP',NULL,'Y','Y',1,'29') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='29' WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Employment Services',NULL,'Y','Y',1,'07') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='07' WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Family/Friend',NULL,'Y','Y',1,'28') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='28' WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Jail',NULL,'Y','Y',1,'17') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='17' WHERE Category = 'REFERRALTYPE' And CodeName='Jail' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Juvenile Justice System/OYA',NULL,'Y','Y',1,'25') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='25' WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Police/Sherriff',NULL,'Y','Y',1,'19') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='19' WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Psychiatric Security review Board (PSRB)',NULL,'Y','Y',1,'20') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='20' WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','School',NULL,'Y','Y',1,'05') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='05' WHERE Category = 'REFERRALTYPE' And CodeName='School' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Self',NULL,'Y','Y',1,'27') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='27' WHERE Category = 'REFERRALTYPE' And CodeName='Self' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Vocational Rehabilitation',NULL,'Y','Y',1,'02') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='02' WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Unknown',NULL,'Y','Y',1,'99') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='99' WHERE Category = 'REFERRALTYPE' And CodeName='Unknown' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Other',NULL,'Y','Y',1,'34') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='34' WHERE Category = 'REFERRALTYPE' And CodeName='Other' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','None',NULL,'Y','Y',1,'35') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='35' WHERE Category = 'REFERRALTYPE' And CodeName='None' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Circuit Court',NULL,'Y','Y',1,'15') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='15' WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Community Housing',NULL,'Y','Y',1,'06') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='06' WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Community Based MH or SA Provider',NULL,'Y','Y',1,'08') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='08' WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Federal Correctional Facility',NULL,'Y','Y',1,'23') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='23' WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Federal Court',NULL,'Y','Y',1,'14') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='14' WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Integrated Treatment Court',NULL,'Y','Y',1,'24') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='24' WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Justice Court',NULL,'Y','Y',1,'16') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='16' WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Local MH Authority/Community MH Provider',NULL,'Y','Y',1,'09') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='09' WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Municipal Court',NULL,'Y','Y',1,'13') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='13' WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Parole',NULL,'Y','Y',1,'18') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='18' WHERE Category = 'REFERRALTYPE' And CodeName='Parole' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Probation',NULL,'Y','Y',1,'21') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='21' WHERE Category = 'REFERRALTYPE' And CodeName='Probation' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Private Health Professional',NULL,'Y','Y',1,'12') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='12' WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','State Correctional Facility',NULL,'Y','Y',1,'22') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='22' WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','State Psychiatric Facility',NULL,'Y','Y',1,'10') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='10' WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility' END 
IF NOT EXISTS (SELECT * FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') begin INSERT INTO globalcodes (Category, CodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1) values('REFERRALTYPE','Veterans Affairs (VA)',NULL,'Y','Y',1,'34') END ELSE BEGIN UPDATE globalcodes  set Description=NULL,Active='Y',CannotModifyNameOrDelete='Y',SortOrder=1, ExternalCode1='34' WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)' END 




--Insert Script for GlobalSubCodes 'REFERRALTYPE'
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='ADES') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Advocacy Group') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Aging and People with Disabilities') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Attorney') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Child Welfare (CW)') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Coordinated Care Organization') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Crisis/Helpline') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Developmental Disabilities') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment/EAP') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Employment Services') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Family/Friend') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Jail') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Juvenile Justice System/OYA') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Police/Sherriff') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Psychiatric Security review Board (PSRB)') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='School') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Self') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Vocational Rehabilitation') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Unknown') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Other') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='None') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Circuit Court') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Housing') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Community Based MH or SA Provider') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Correctional Facility') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Federal Court') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Integrated Treatment Court') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Justice Court') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Local MH Authority/Community MH Provider') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Municipal Court') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Parole') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Probation') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional') And SubCodeName='Public Health Department') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional'),'Public Health Department',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional'), SubCodeName='Public Health Department', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional') And SubCodeName='Public Health Department' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional') And SubCodeName='St. Al''s Baker Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional'),'St. Al''s Baker Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional'), SubCodeName='St. Al''s Baker Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional') And SubCodeName='St. Al''s Baker Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional') And SubCodeName='St. Al''s Valley Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional'),'St. Al''s Valley Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional'), SubCodeName='St. Al''s Valley Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional') And SubCodeName='St. Al''s Valley Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional') And SubCodeName='St. Luke''s EOMA') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional'),'St. Luke''s EOMA',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional'), SubCodeName='St. Luke''s EOMA', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Private Health Professional') And SubCodeName='St. Luke''s EOMA' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Correctional Facility') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='State Psychiatric Facility') And SubCodeName='Substance Use Outpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Assisted Living') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Assisted Living',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Assisted Living', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Assisted Living' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Attorney') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Attorney',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Attorney', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Attorney' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Community Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Community Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Community Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Community Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Court') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Court',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Court', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Court' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Emergency Room') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Emergency Room',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Emergency Room', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Emergency Room' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Jail/Police') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Jail/Police',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Jail/Police', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Jail/Police' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Nursing Facility') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Nursing Facility',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Nursing Facility', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Nursing Facility' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Nursing Home Ext Care') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Nursing Home Ext Care',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Nursing Home Ext Care', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Nursing Home Ext Care' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Other',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Other', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other CMHC') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Other CMHC',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Other CMHC', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other CMHC' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other Inpt Residential') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Other Inpt Residential',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Other Inpt Residential', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other Inpt Residential' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other Physician') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Other Physician',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Other Physician', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other Physician' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other Private MH Practitioner') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Other Private MH Practitioner',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Other Private MH Practitioner', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Other Private MH Practitioner' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Outpt Psych Clinic') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Outpt Psych Clinic',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Outpt Psych Clinic', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Outpt Psych Clinic' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Private Psychiatrist') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Private Psychiatrist',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Private Psychiatrist', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Private Psychiatrist' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Probation/Parole') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Probation/Parole',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Probation/Parole', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Probation/Parole' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Psychiatric Hospital') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Psychiatric Hospital',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Psychiatric Hospital', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Psychiatric Hospital' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='School District/School') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'School District/School',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='School District/School', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='School District/School' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Self') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Self',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Self', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Self' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Social Service Agency') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Social Service Agency',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Social Service Agency', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Social Service Agency' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Substance Use Inpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Substance Use Inpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Substance Use Inpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Substance Use Inpt Tx' end
IF NOT EXISTS (SELECT * FROM globalsubcodes where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Substance Use Outpt Tx') begin  INSERT INTO globalsubcodes (GlobalCodeId, SubCodeName, Description, Active, CannotModifyNameOrDelete, SortOrder,ExternalCode1, ExternalSource1, ExternalCode2, ExternalSource2, Bitmap) VALUES((SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'),'Substance Use Outpt Tx',NULL,'Y','N',1,NULL,NULL,NULL,NULL,NULL) end else begin update globalsubcodes set GlobalCodeId= (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)'), SubCodeName='Substance Use Outpt Tx', Description=NULL, Active='Y', CannotModifyNameOrDelete='N', SortOrder=0,ExternalCode1= NULL, ExternalSource1=NULL, ExternalCode2=NULL, ExternalSource2=NULL, Bitmap=NULL where GlobalCodeId in (SELECT GlobalCodeId FROM globalcodes WHERE Category = 'REFERRALTYPE' And CodeName='Veterans Affairs (VA)') And SubCodeName='Substance Use Outpt Tx' end






